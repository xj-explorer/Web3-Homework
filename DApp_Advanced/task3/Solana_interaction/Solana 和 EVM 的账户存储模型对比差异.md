## Solana 和 EVM 的账户存储模型对比差异

- ### 账户类型与结构

  - **Solana**：账户类型包括程序账户和数据账户等。程序账户存储可执行代码，由 BPF 加载器程序拥有，不可变；数据账户存储状态数据，由程序账户拥有和控制。此外还有原生账户和 Sysvar 账户等特殊类型，每个账户有唯一的 32 字节地址，最大大小为 10MiB。
  - **EVM**：分为外部账户（EOA）和合约账户。外部账户由私钥控制，可发起交易和持有 ETH；合约账户由代码控制，可持有 ETH 并执行逻辑，但需 EOA 触发。每个账户都有一个状态结构，包括 nonce、balance、storageRoot 和 codeHash 等字段。

- ### 状态存储方式

  - **Solana**：程序的可执行代码存储在程序账户中，状态数据存储在外部的数据账户中，程序执行时需传入相关数据账户。例如，一个游戏程序可能有一个账户存储程序代码，多个账户分别存储不同玩家的游戏进度等状态数据。
  - **EVM**：智能合约存储自己的状态，合约状态与执行逻辑捆绑在一起，通过内部的键值对（Storage）进行管理，合约可以直接读写自身的存储。如在 Solidity 编写的合约中，状态变量会存储在合约的 Storage 中，合约可以直接对其进行操作。

- ### 存储成本

  - **Solana**：采用租金机制，账户需存储至少 2 年租金的 SOL 余额，租金根据数据大小计算，若余额低于租金阈值，数据可能被清除，但关闭账户时可全额取回租金。
  - **EVM**：无租金机制，存储永久存在，但用户需要一次性支付 Gas 费用来覆盖存储和计算成本，Gas 费用根据操作的复杂程度和存储使用量等因素计算。

- ### 权限控制

  - **Solana**：只有账户的所有者程序可以修改其数据或扣除其 lamport 余额，但任何人都可以增加余额。例如，转账操作需由系统程序作为所有者程序来修改发送方和接收方的数据账户余额。
  - **EVM**：外部账户由私钥控制，可发起交易和操作；合约账户由其代码控制，只有符合合约逻辑的操作才能执行，且合约只能读写自身存储，不能直接访问其他合约的存储。